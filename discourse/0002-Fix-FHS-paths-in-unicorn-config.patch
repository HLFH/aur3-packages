From 89d8a4d123df79fd65a0545ed8ba767720ccd7f0 Mon Sep 17 00:00:00 2001
From: Stefan Tatschner <stefan@sevenbyte.org>
Date: Sun, 7 Jun 2015 12:45:45 +0200
Subject: [PATCH] Fix FHS paths in unicorn config

---
 config/unicorn.conf.rb | 12 +++++-------
 1 file changed, 5 insertions(+), 7 deletions(-)

diff --git a/config/unicorn.conf.rb b/config/unicorn.conf.rb
index 647b1f1..2666268 100644
--- a/config/unicorn.conf.rb
+++ b/config/unicorn.conf.rb
@@ -3,27 +3,25 @@
 # enable out of band gc out of the box, it is low risk and improves perf a lot
 ENV['UNICORN_ENABLE_OOBGC'] ||= "1"
 
-discourse_path = File.expand_path(File.expand_path(File.dirname(__FILE__)) + "/../")
-
 # tune down if not enough ram
 worker_processes (ENV["UNICORN_WORKERS"] || 3).to_i
 
-working_directory discourse_path
+working_directory '/usr/share/webapps/discourse'
 
 # listen "#{discourse_path}/tmp/sockets/unicorn.sock"
-listen (ENV["UNICORN_PORT"] || 3000).to_i
+listen (ENV["UNICORN_PORT"] || 9737).to_i
 
 # nuke workers after 30 seconds instead of 60 seconds (the default)
 timeout 30
 
 # feel free to point this anywhere accessible on the filesystem
-pid "#{discourse_path}/tmp/pids/unicorn.pid"
+pid '/run/discourse/unicorn.pid'
 
 # By default, the Unicorn logger will write to stderr.
 # Additionally, some applications/frameworks log to stderr or stdout,
 # so prevent them from going to /dev/null when daemonized here:
-stderr_path "#{discourse_path}/log/unicorn.stderr.log"
-stdout_path "#{discourse_path}/log/unicorn.stdout.log"
+stderr_path '/var/log/discourse/unicorn.stderr.log'
+stdout_path '/var/log/discourse/unicorn.stdout.log'
 
 # important for Ruby 2.0
 preload_app true
-- 
2.4.2

